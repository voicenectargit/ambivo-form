<ng-container *ngIf="widget$ | async as widget">
  <ng-container *ngIf="widget.body as data">
    <!-- Font -->
    <ng-container *ngIf="data.styling">
      <font-loader [font]="data.styling['--font-family']"></font-loader>
    </ng-container>

    <div class="ambivo-form" [style.width]="width" [style]="data.styling">
      <!-- Header -->
      <div class="ambivo-form--header" *ngIf="data.title as title">
        <img [src]="logo" *ngIf="data.logo as logo" class="ambivo-form--logo" />
        <div>
          <div class="ambivo-form--title">{{ title }}</div>
          <div class="ambivo-form--subtitle" *ngIf="data.subtitle as subtitle">
            {{ subtitle }}
          </div>
        </div>
      </div>

      <!-- Form -->
      <form [formGroup]="form" (ngSubmit)="submit()">
        <formly-form
          [form]="form"
          [fields]="data.fields"
          [model]="model"
        ></formly-form>

        <!-- Submit -->
        <button
          type="submit"
          class="ambivo-form--button"
          (click)="submit(widget)"
          [disabled]="!widget.id || !form.valid || isLoading"
          *ngIf="!data.multistep"
        >
          {{ data.submit }}
        </button>
      </form>
    </div>
  </ng-container>
</ng-container>
